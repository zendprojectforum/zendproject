
<style> 
    .reply {
        border: 2px solid;
        margin: 10px;
        padding: 20px;
    }

    #thread{
        border:solid 5px; 
        margin: 10px;
        padding:20px;
    }

    #replies{
        margin:70px; 
        padding:20px;
    }

    img{
        width: 40px;
        height: 40px;
    }
</style>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script src="http://localhost/zend_project/public/media/js/thread/showthread.js" ></script>

<?php
$username = $this->myInfo->username;
$image = $this->baseUrl() . "/media/images/" . $this->myInfo->signature;
$profpic = $this->baseUrl() . "/media/images/" . $this->myInfo->profpic;
$myId = $this->myInfo->id;
$isadmin = $this->myInfo->isAdmin;
$isban = $this->myInfo->isBan;



//$x = getcwd ();
//$this->HeadScript()->appendFile('http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js','text/javascript');
//$this->HeadScript()->appendFile($x.'/js/showThread.js','text/javascript');
//$this->inlineScript()->appendFile($this->baseUrl($x.'js/showThread.js'));
// $this->HeadScript()->appendFile('http://localhost/zend_project/public/js/showThread.js','text/javascript');
?>


<br /><br />
<div id="view-content">

    <?php
    //display thread
    $funcStr = "this,\"". $this->threadUser[1] . "\" , \"".$this->baseUrl() . "/media/images/" . $this->threadUser[2]."\"" ;
    
    echo "<div  id = 'thread'  > "
    . "<img style='padding-right: 12px;' src='" . $this->baseUrl() . "/media/images/" . $this->threadUser[3] . "' >"
    
    . "<span class='label label-default' style='font-size:30px;'><label >" . $this->threadUser[1] . "</span></label>"
    
    . "<br/>".$this->thread['date'] . "<br/>"
    . "<h1>" . $this->thread['threadTitle'] . "</h1>"
    . "<p>" . $this->thread['body'] . "</p>"
    
    . "<img style='width: 176px;height: 187px;'src='" . $this->baseUrl() . "/media/images/" . $this->threadUser[2] . "'>";
    if ($isadmin || ($myId == $this->threadUser[0])) {
        echo "<button name='" . $this->thread['threadId'] . "' onclick='editThread(".$funcStr." )'>Edit</button>"
        . "<button  name='" . $this->thread['threadId'] . "' onclick='deleteThreadthis)'>Delete</button></div>";
    } else {
        echo "</div>";
    }


    //display replies
    $i = 0;
    echo "<div id = 'replies' >";
    foreach ($this->replies as $reply) {
        
    if ($this->users[$i][3] ||  !($this->users[$i][4])){  //admin or not banned
        echo "<div id='" . $reply['replyId'] . "' class='reply' >";
        echo "<img src=" . $this->baseUrl() . "/media/images/" . $this->users[$i][5] . " >"  //image
                
        ."<span class='label label-default' style='font-size:30px;'> <label>" . $this->users[$i][1] . "</label></span>";  //username
        
        
        if ($reply['edited']) {
            echo "<label> Edited </label>";
        }
        echo $reply['Date'];
        echo "<br><p>" . $reply['body'] . "</p>";
        echo "<img style='width: 160px;height: 160px;' src=" . $this->baseUrl() . "/media/images/" . $this->users[$i][2] . " >";  //image
    if ($isadmin ||($myId == $this->users[$i][0])){
        echo "<button onclick='edit(this)'>Edit</button>";
        echo "<button onclick='deleteReply(this)'>Delete</button></div>";
    }
    else{
        echo "</div>";
    }
    }
            $i++;

    }
    echo "</div></div>";
    
    
if (!$isban){
    echo "<textarea class='replyText' cols='50' rows='10' placeholder='Add reply...' ></textarea>";
    echo "<button  onclick=\"reply(" .$this->id ." ,'$username','$image' )\" type='submit'>Reply</button>";
}
?>
